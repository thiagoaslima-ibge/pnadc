function AlertUserOfAPIError(e){if(g_bShowApiErrors){var r=e+"\n\n"+g_strDisableErrorMsgs;confirm(r)||(g_bShowApiErrors=!1)}}function ExpandString(e){var r=new RegExp("%","g");for(i=arguments.length-1;i>0;i--)s2="%"+i,e.indexOf(s2)>-1&&(r.compile(s2,"g"),e=e.replace(r,arguments[i]));return e}function FindAPI(e){for(;null==e.API&&null!=e.parent&&e.parent!=e;){if(g_nFindAPITries++,g_nFindAPITries>500)return AlertUserOfAPIError(g_strAPITooDeep),null;e=e.parent}return e.API}function APIOK(){return"undefined"!=typeof g_objAPI&&null!=g_objAPI}function SCOInitialize(e){void 0!=e&&(g_sessionTimeCookie=e);var r=!0;return g_bInitDone||(window.parent&&window.parent!=window&&(g_objAPI=FindAPI(window.parent)),null==g_objAPI&&null!=window.opener&&(g_objAPI=FindAPI(window.opener)),APIOK()?(r=g_objAPI.LMSInitialize(""),"true"==r?(g_bSCOBrowse="browse"==g_objAPI.LMSGetValue("cmi.core.lesson_mode"),g_bSCOBrowse||"not attempted"==g_objAPI.LMSGetValue("cmi.core.lesson_status")&&(r=g_objAPI.LMSSetValue("cmi.core.lesson_status","incomplete"))):AlertUserOfAPIError(g_strAPIInitFailed)):(AlertUserOfAPIError(g_strAPINotFound),r=!1),"undefined"!=typeof SCOInitData&&SCOInitData(),g_dtmInitialized=new Date),g_bInitDone=!0,r+""}function SCOFinish(){return APIOK()&&0==g_bFinishDone&&(SCOReportSessionTime(),g_bSetCompletedAutomatically&&SCOSetStatusCompleted(),"undefined"!=typeof SCOSaveData&&SCOSaveData(),g_bFinishDone="true"==g_objAPI.LMSFinish("")),g_bFinishDone+""}function SCOGetValue(e){return APIOK()?g_objAPI.LMSGetValue(e.toString()):""}function SCOCommit(){return APIOK()?g_objAPI.LMSCommit(""):"false"}function SCOGetLastError(){return APIOK()?g_objAPI.LMSGetLastError():"-1"}function SCOGetErrorString(e){return APIOK()?g_objAPI.LMSGetErrorString(e):"No API"}function SCOGetDiagnostic(e){return APIOK()?g_objAPI.LMSGetDiagnostic(e):"No API"}function SCOSetValue(e,r){var t="";return APIOK()?"cmi.core.score.raw"==e&&(t=privReportRawScore(r)):(AlertUserOfAPIError(g_strAPISetError+"\n"+e+"\n"+r),t="false"),""==t&&(t=g_objAPI.LMSSetValue(e,r.toString()+""),"true"!=t)?t:("cmi.core.score.min"==e?(g_bMinScoreAcquired=!0,g_nSCO_ScoreMin=r):"cmi.core.score.max"==e&&(g_bMaxScoreAcquired=!0,g_nSCO_ScoreMax=r),t)}function privReportRawScore(e){if(isNaN(e))return"false";if(!g_bMinScoreAcquired&&"true"!=g_objAPI.LMSSetValue("cmi.core.score.min",g_nSCO_ScoreMin+""))return"false";if(!g_bMaxScoreAcquired&&"true"!=g_objAPI.LMSSetValue("cmi.core.score.max",g_nSCO_ScoreMax+""))return"false";if("true"!=g_objAPI.LMSSetValue("cmi.core.score.raw",e))return"false";if(g_bMinScoreAcquired=!1,g_bMaxScoreAcquired=!1,!g_bMasteryScoreInitialized){var r=parseInt(SCOGetValue("cmi.student_data.mastery_score"),10);isNaN(r)||(g_SCO_MasteryScore=r)}if(g_bInterpretMasteryScore&&!isNaN(g_SCO_MasteryScore)){var t=e>=g_SCO_MasteryScore?"passed":"failed";if("true"!=SCOSetValue("cmi.core.lesson_status",t))return"false"}return"true"}function MillisecondsToCMIDuration(e){var r="",t=new Date;t.setTime(e);var i="000"+Math.floor(e/36e5),n="0"+t.getMinutes(),a="0"+t.getSeconds(),o="0"+Math.round(t.getMilliseconds()/10);return r=i.substr(i.length-4)+":"+n.substr(n.length-2)+":",r+=a.substr(a.length-2)+"."+o.substr(o.length-2)}function SCOReportSessionTime(){var e=new Date,r=e.getTime()-g_dtmInitialized.getTime();if(g_sessionTimeCookie){var t=new RegExp("session_time=([^;]+)"),i=t.exec(document.cookie);null!=i&&(r+=parseInt(unescape(i[1]))),document.cookie="session_time="+r}return SCOSetValue("cmi.core.session_time",MillisecondsToCMIDuration(r))}function SCOSetStatusCompleted(){var e=SCOGetValue("cmi.core.lesson_status");return"browse"==SCOGetValue("cmi.core.lesson_mode")?"false":"completed"!=e&&"passed"!=e&&"failed"!=e?SCOSetValue("cmi.core.lesson_status","completed"):void 0}function SCOSetObjectiveData(e,r,t){var i="false",n=SCOGetObjectiveIndex(e);return isNaN(n)?(n=parseInt(SCOGetValue("cmi.objectives._count")),isNaN(n)&&(n=0),"true"==SCOSetValue("cmi.objectives."+n+".id",e)&&(i=SCOSetValue("cmi.objectives."+n+"."+r,t))):(i=SCOSetValue("cmi.objectives."+n+"."+r,t),"true"!=i&&(n=parseInt(SCOGetValue("cmi.objectives._count")),isNaN(n)||"true"==SCOSetValue("cmi.objectives."+n+".id",e)&&(i=SCOSetValue("cmi.objectives."+n+"."+r,t)))),i}function SCOGetObjectiveData(e,r){var t=SCOGetObjectiveIndex(e);return isNaN(t)?"":SCOGetValue("cmi.objectives."+t+"."+r)}function SCOGetObjectiveIndex(e){var r=-1,t=parseInt(SCOGetValue("cmi.objectives._count"));if(!isNaN(t))for(r=t-1;r>=0;r--)if(SCOGetValue("cmi.objectives."+r+".id")==e)return r;return NaN}function AICCTokenToSCORMToken(e,r){var t=e.split(","),n=r.substr(0,1).toLowerCase();for(i=0;i<t.length;i++)if(n==t[i].substr(0,1))return t[i];return r}function normalizeStatus(e){return AICCTokenToSCORMToken("completed,incomplete,not attempted,failed,passed",e)}function normalizeInteractionType(e){return AICCTokenToSCORMToken("true-false,choice,fill-in,matching,performance,sequencing,likert,numeric",e)}function normalizeInteractionResult(e){return AICCTokenToSCORMToken("correct,wrong,unanticipated,neutral",e)}function base_DoFSCommand(command,args){var baseObj=g_bIsInternetExplorer?base:document.base,myArgs=new String(args),cmd=new String(command),v="",err="true",arg1,arg2,n,s,i,sep=myArgs.indexOf(",");if(sep>-1?(arg1=myArgs.substr(0,sep),arg2=myArgs.substr(sep+1)):arg1=myArgs,APIOK()){if("LMS"==cmd.substring(0,3))"LMSInitialize"==cmd?err=APIOK()+"":"LMSSetValue"==cmd?err=SCOSetValue(arg1,arg2):"LMSFinish"==cmd?err=SCOFinish():"LMSCommit"==cmd?err=SCOCommit():"LMSFlush"==cmd||(arg2&&arg2.length>0?"LMSGetValue"==cmd?baseObj.SetVariable(arg2,SCOGetValue(arg1)):"LMSGetLastError"==cmd?baseObj.SetVariable(arg2,SCOGetLastError(arg1)):"LMSGetErrorString"==cmd?baseObj.SetVariable(arg2,SCOGetLastError(arg1)):"LMSGetDiagnostic"==cmd?baseObj.SetVariable(arg2,SCOGetDiagnostic(arg1)):(v=eval("g_objAPI."+cmd+'("'+arg1+'")'),baseObj.SetVariable(arg2,v)):"LMSGet"==cmd.substring(0,3)&&(err="-2: No Flash variable specified"));else if("MM_cmi"==cmd.substring(0,6)||"CMISet"==cmd.substring(0,6)){var F_intData=myArgs.split(";");if("MM_cmiSendInteractionInfo"==cmd){if(n=SCOGetValue("cmi.interactions._count"),s="cmi.interactions."+n+".",v=F_intData[2],null!=v&&""!=v||(err=201),"true"==err&&(err=SCOSetValue(s+"id",v)),"true"==err){var re=new RegExp("[{}]","g");for(i=1;i<9&&"true"==err;i++)v=F_intData[i],null!=v&&""!=v&&(1==i?err=SCOSetValue(s+"time",v):3==i?err=SCOSetValue(s+"objectives.0.id",v):4==i?err=SCOSetValue(s+"type",normalizeInteractionType(v)):5==i?(v=v.replace(re,""),err=SCOSetValue(s+"correct_responses.0.pattern",v)):6==i?(v=v.replace(re,""),err=SCOSetValue(s+"student_response",v)):7==i?err=SCOSetValue(s+"result",normalizeInteractionResult(v)):8==i?err=SCOSetValue(s+"weighting",v):9==i&&(err=SCOSetValue(s+"latency",v)))}}else"MM_cmiSendObjectiveInfo"==cmd?(err=SCOSetObjectiveData(F_intData[1],".score.raw",F_intData[2]),"true"==err&&SCOSetObjectiveData(F_intData[1],".status",normalizeStatus(F_intData[3]))):"CMISetScore"==cmd||"MM_cmiSendScore"==cmd?err=SCOSetValue("cmi.core.score.raw",F_intData[0]):"CMISetStatus"==cmd||"MM_cmiSetLessonStatus"==cmd?err=SCOSetValue("cmi.core.lesson_status",normalizeStatus(F_intData[0])):"CMISetTime"==cmd?err=SCOSetValue("cmi.core.session_time",F_intData[0]):"CMISetCompleted"==cmd?err=SCOSetStatusCompleted():"CMISetStarted"==cmd?err=SCOSetValue("cmi.core.lesson_status","incomplete"):"CMISetPassed"==cmd?err=SCOSetValue("cmi.core.lesson_status","passed"):"CMISetFailed"==cmd?err=SCOSetValue("cmi.core.lesson_status","failed"):"CMISetData"==cmd?err=SCOSetValue("cmi.suspend_data",F_intData[0]):"CMISetLocation"==cmd?err=SCOSetValue("cmi.core.lesson_location",F_intData[0]):"CMISetTimedOut"==cmd&&(err=SCOSetValue("cmi.core.exit","time-out"))}else"CMIFinish"==cmd||"CMIExitAU"==cmd?err=SCOFinish():"CMIInitialize"==cmd||"MM_StartSession"==cmd?err=SCOInitialize():eval("g_objAPI."+cmd)?(v=eval("g_objAPI."+cmd+'("'+arg1+'")'),arg2&&arg2.length>0?baseObj.SetVariable(arg2,v):err=v):err="false";return g_bShowApiErrors&&"true"!=err&&AlertUserOfAPIError(ExpandString(g_strFSAPIError,err,cmd,args)),err}}var g_bShowApiErrors=!1,g_bInitializeOnLoad=!0,g_strAPINotFound="Management system interface not found.",g_strAPITooDeep="Cannot find API - too deeply nested.",g_strAPIInitFailed="Found API but LMSInitialize failed.",g_strAPISetError="Trying to set value but API not available.",g_strFSAPIError='LMS API adapter returned error code: "%1"\nWhen FScommand called API.%2\nwith "%3"',g_strDisableErrorMsgs="Select cancel to disable future warnings.",g_bSetCompletedAutomatically=!1,g_SCO_MasteryScore=null,g_nSCO_ScoreMin=0,g_nSCO_ScoreMax=100,g_bInterpretMasteryScore=!0,g_nFindAPITries=0,g_objAPI=null,g_bInitDone=!1,g_bFinishDone=!1,g_bSCOBrowse=!1,g_dtmInitialized=new Date,g_bMasteryScoreInitialized=!1,g_sessionTimeCookie=!1,g_bMinScoreAcquired=!1,g_bMaxScoreAcquired=!1,g_bIsInternetExplorer=navigator.appName.indexOf("Microsoft")!=-1;